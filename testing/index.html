<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Testing - Parsec Development Document</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Parsec Development Document</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../quickstart/">Getting Started</a>
</li>
                            
<li >
    <a href="../main/">Main Components</a>
</li>
                            
<li >
    <a href="../util/">Supporting Libraries and Utilities</a>
</li>
                            
<li class="active">
    <a href="./">Testing</a>
</li>
                            
<li >
    <a href="../endpoint/">API Endpoint Definition</a>
</li>
                            
<li >
    <a href="../faq/">Frequently Asked Questions</a>
</li>
                            
<li >
    <a href="../todo/">Todo</a>
</li>
                            
<li >
    <a href="../reference/">Reference</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../util/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../endpoint/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/yahoo/parsec/edit/master/docs/testing.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#testing">Testing</a></li>
            <li><a href="#unit-testing">Unit Testing</a></li>
            <li><a href="#smoke-and-functional-testing">Smoke and Functional Testing</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="testing">Testing</h1>
<h2 id="unit-testing">Unit Testing</h2>
<h3 id="spock">Spock</h3>
<p>As the default unit test framework, Spock has a number of features:</p>
<blockquote>
<ul>
<li>Enables Behavior-Driven Development</li>
<li>Uses Groovy which makes it easier to develop test cases</li>
<li>Tests are descriptive, making them easier to understand and manage</li>
<li>Has powerful features such as mocking methods by regex match</li>
</ul>
</blockquote>
<p>Ideally, each piece of Spock code should be fairly self-explanatory. For
instance, a test method that checks for non-null variable may look like
this:</p>
<pre><code class="java">import spock.lang.Specification

class MyClassTest extends Specification {
    def &quot;ensure that foo is not null&quot;() {
        given: def myClass = new MyClass()
        when: def foo = myClass.getFoo()
        then: foo != null
    }
}
</code></pre>

<p>Another example that mocks with sample data in Spock:</p>
<pre><code class="java">class SampleHandlerImplTest extends Specification {    
    def &quot;test post user&quot;() {
        given: 
        def impl = new SampleHandlerImpl()
        def context = Mock(SampleResourceContext)
        context.request() &gt;&gt; Mock(HttpServletRequest)

        expected:
        impl.postUser(context, new User().setName(name)) == result

        where:
        name   || result
        &quot;jake&quot; || &quot;\&quot;Hello jake!\&quot;\n&quot;
    }
}
</code></pre>

<p>Besides being highly descriptive, Spock is also packed with powerful
features such as regex mocking. For example, to match all setter methods
of a given object:</p>
<pre><code class="java">class MyClassTest extends Specification {
    def &quot;ensure that foo is not null&quot;() {
        given: def myClass = new MyClass()
        when: def foo = myClass.getFoo()

        then:
        foo != null
        // check if call to any setter of myClass with any argument once
        1 * myClass./set.*/(_) 
    }
}
</code></pre>

<p>To learn more about other Spock features, refer to the official <a href="http://spockframework.github.io/spock/docs/1.0/index.html">Spock
documentation</a>.</p>
<p><strong>Note: By default Spock test files should be placed under
src/test/groovy</strong></p>
<p>Getting started with Spock should be straightforward if you are already
familiar with Java or Groovy. If you are unfamiliar with Java, learning
Groovy would probably be easier than learning Java. Here is some
documentation to get you started:</p>
<blockquote>
<ul>
<li><a href="http://spockframework.github.io/spock/docs/1.0/spock_primer.html">Spock
    Primer</a></li>
<li><a href="http://groovy-lang.org/documentation.html">Groovy documentation</a></li>
</ul>
</blockquote>
<p>Or if you prefer to learn by example or prefer actual code for
referencing:</p>
<blockquote>
<ul>
<li><a href="https://github.com/spockframework/spock-example/tree/master/src/test/groovy">Official Spock
    example</a></li>
</ul>
</blockquote>
<h4 id="alternative-test-frameworks">Alternative test frameworks</h4>
<p>Alternative recommend unit test framewords are JUnit and TestNG.</p>
<h3 id="junit">JUnit</h3>
<p>Spock depends on JUnit. Place your test files under <strong>src/test/java</strong> to
run tests with JUnit.</p>
<h3 id="testng">TestNG</h3>
<p>Spock and JUnit conflicts with TestNG. To use TestNG you will need to
remove <strong>spock-core</strong> from your build.gradle and add TestNG dependencies.</p>
<pre><code>dependencies {
    compile group: 'org.spockframework', name: 'spock-core', version: '1.1-groovy-2.4-rc-3'
}
</code></pre>

<p><a href="http://mvnrepository.com/artifact/org.testng/testng">TestNG on
mvnrepository.com</a></p>
<h2 id="smoke-and-functional-testing">Smoke and Functional Testing</h2>
<p>Cucumber-JVM + Groovy is the recommended framework for integration tests
of Parsec services for reasons that include:</p>
<blockquote>
<ul>
<li><strong>Behaviour Driven Design (BDD)</strong> reduces the gap between product
    requirements and software development and is aligned with agile
    development.</li>
<li><strong>Cucumber-JVM</strong> is a tool that implements a BDD workflow.
    Cucumber-JVM is a pure Java implementation of Cucumber.</li>
<li><strong>Groovy</strong> is a JVM-based language and itâ€™s fully compatible with
    pure Java libraries.</li>
<li><strong>Spock</strong> is also implemented using Groovy</li>
</ul>
</blockquote>
<p>Before you start, make sure the following <strong>Cucumber dependencies are in
your build.gradle</strong>:</p>
<pre><code>dependencies {
    compile group: 'info.cukes', name: 'cucumber-junit', version: '1.2.5'
    compile group: 'info.cukes', name: 'cucumber-groovy', version: '1.2.5'
    compile group: 'info.cukes', name: 'cucumber-java', version: '1.2.5'
}
</code></pre>

<p>The following steps will help you get started:</p>
<blockquote>
<ul>
<li>write scenarios in feature files (*.feature)</li>
<li>implement RunCukesIT.java</li>
<li>implement step definitions (*.groovy)</li>
<li>integrate with CD</li>
</ul>
</blockquote>
<p>If you're not familiar with BDD or Cucumber, here are some resources to
get you started:</p>
<blockquote>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Behavior-driven_development">Behavior Driven Development
    wiki</a></li>
<li><a href="https://en.wikipedia.org/wiki/Cucumber_(software)">Cucumber wiki</a></li>
</ul>
</blockquote></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2017 <a href="http://www.yahoo.com">Yahoo! Inc.</a></p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
