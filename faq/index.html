<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>Frequently Asked Questions - Parsec Development Document</title>
        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.5.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">
        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script> 
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="..">Parsec Development Document</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                    <li >
                        <a href="..">Home</a>
                    </li>
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">User Guide <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                            
<li >
    <a href="../quickstart/">Getting Started</a>
</li>
                            
<li >
    <a href="../main/">Main Components</a>
</li>
                            
<li >
    <a href="../util/">Supporting Libraries and Utilities</a>
</li>
                            
<li >
    <a href="../testing/">Testing</a>
</li>
                            
<li >
    <a href="../endpoint/">API Endpoint Definition</a>
</li>
                            
<li class="active">
    <a href="./">Frequently Asked Questions</a>
</li>
                            
<li >
    <a href="../todo/">Todo</a>
</li>
                            
<li >
    <a href="../reference/">Reference</a>
</li>
                        </ul>
                    </li>
                </ul>

            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="#" data-toggle="modal" data-target="#mkdocs_search_modal">
                        <i class="fa fa-search"></i> Search
                    </a>
                </li>
                    <li >
                        <a rel="next" href="../endpoint/">
                            <i class="fa fa-arrow-left"></i> Previous
                        </a>
                    </li>
                    <li >
                        <a rel="prev" href="../todo/">
                            Next <i class="fa fa-arrow-right"></i>
                        </a>
                    </li>
                    <li>
                        <a href="https://github.com/yahoo/parsec/edit/master/docs/faq.md"><i class="fa fa-github"></i> Edit on GitHub</a>
                    </li>
            </ul>
        </div>
    </div>
</div>

        <div class="container">
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
        <li class="main active"><a href="#frequently-asked-questions">Frequently Asked Questions</a></li>
            <li><a href="#resolved">Resolved</a></li>
            <li><a href="#pending">Pending</a></li>
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="frequently-asked-questions">Frequently Asked Questions</h1>
<h2 id="resolved">Resolved</h2>
<h3 id="how-do-i-add-default-value-in-response-header-for-specific-end-points">How do I add default value in response header for specific end points?</h3>
<ul>
<li>It seems there is no existing filter to handle response header.</li>
<li>you can add headers to ResourceContext of specific endpoints
    implementation example as below:</li>
</ul>
<p><em>SampleHandlerImpl.java</em></p>
<pre><code>@Override
public Users getUsers(ResourceContext context, String ids) {
    List&lt;String&gt; idList = Arrays.asList(ids.split(&quot;,&quot;));
    List&lt;User&gt; userList = new ArrayList&lt;User&gt;();
    for (String id : idList) {
        User u = new User();
        u.setId(id);
        u.setName(&quot;name_&quot; + id);
        userList.add(u);
    }

    // prepare response object
    Users users = new Users();
    users.setUsers(userList);

    // set cache control header 24h
    long expires = System.currentTimeMillis() + EXPIRES_IN_MS;

    context.response().setHeader(&quot;Cache-Control&quot;, &quot;public&quot;);
    context.response().setDateHeader(&quot;Expires&quot;, expires);
    return users;
}
</code></pre>

<h3 id="how-do-i-show-detailed-or-backtrace-log-when-server-has-errors">How do I show detailed or backtrace log when server has errors?</h3>
<ul>
<li>For local Jetty, edit gradle.properties setting:</li>
</ul>
<pre><code>systemProp.log4j.debug=1
</code></pre>

<h3 id="how-do-i-display-optional-or-required-for-data-objects-sub-field-in-swagger-ui">How do I display <em>optional</em> or <em>required</em> for data object’s sub field in Swagger UI?</h3>
<ul>
<li>field “name” will be described with required, and the words after
    “//” will be displayed as the field’s description</li>
<li>click on “Model” link (located in “Data Type” column)</li>
</ul>
<p><em>sample.rdl</em></p>
<pre><code>type User struct {
    string name (x_size=&quot;min=3,max=5&quot;, optional); // desc for required name
    int32 age; // desc for optional age
}
</code></pre>

<h3 id="how-do-i-enable-filter-for-specific-endpoint">How do I enable filter for specific endpoint?</h3>
<ul>
<li>register filter to specific servlet whose name is “Web Application”</li>
</ul>
<pre><code>FilterRegistration.Dynamic fooFilter = context.addFilter(&quot;FooFilter&quot;, FOOFilter.class);
fooFilter.addMappingForServletNames(EnumSet.of(DispatcherType.REQUEST), true, &quot;Web Application&quot;);
fooFilter.setInitParameter(&quot;key&quot;, &quot;val&quot;);
</code></pre>

<ul>
<li>register filter to specific endpoint which url matches “/*”</li>
</ul>
<pre><code>FilterRegistration.Dynamic fooFilter = context.addFilter(&quot;FooFilter&quot;, FOOFilter.class);
fooFilter.addMappingForUrlPatterns(EnumSet.of(DispatcherType.REQUEST) ,true,&quot;/*&quot;);
fooFilter.setInitParameter(&quot;key&quot;, &quot;val&quot;);
</code></pre>

<h3 id="how-do-i-return-a-non-200-http-status-code-when-the-request-is-successful-such-as-created-201-accepted-202">How do I return a non-200 http status code when the request is successful, such as Created (201), Accepted (202)?</h3>
<ul>
<li>specify 2xx (non 200) status code mapping to your data object</li>
</ul>
<p><em>Sample.rdl</em></p>
<pre><code>type User struct {
    string name (x_size=&quot;min=3,max=5&quot;);
    int32 age;
}

resource User POST &quot;/user&quot; {
    User user (x_must_validate);

    expected CREATED;
    exceptions {
        ResourceError INTERNAL_SERVER_ERROR;
        ResourceError BAD_REQUEST;
        ResourceError UNAUTHORIZED;
        ResourceError FORBIDDEN;
        User CREATED;
    }
}
</code></pre>

<ul>
<li>throw ResourceException with you expected success status code with
    response data object</li>
</ul>
<p><em>SampleHandlerImpl.java</em></p>
<pre><code>public class SampleHandlerImpl implements SampleHandler {

   @Override
   public User postUser(ResourceContext context, User user) {
       //return &quot;Hello &quot; + user.getName() + &quot;!\n&quot;;
       throw new ResourceException(ResourceException.CREATED, user);
   }

   ....
}
</code></pre>

<p><em>the output will be</em></p>
<pre><code>$ curl -v -H &quot;Content-Type: application/json&quot; http://wifi-9-152.tpcity.corp.yahoo.com:8080/api/sample/v1/user -d '{&quot;age&quot;:0, &quot;name&quot;:&quot;name&quot;}'

* Hostname was NOT found in DNS cache
*   Trying 10.82.9.152...
* Connected to wifi-9-152.tpcity.corp.yahoo.com (10.82.9.152) port 8080 (#0)
&gt; POST /api/sample/v1/user HTTP/1.1
&gt; User-Agent: curl/7.37.1
&gt; Host: wifi-9-152.tpcity.corp.yahoo.com:8080
&gt; Accept: */*
&gt; Content-Type: application/json
&gt; Content-Length: 24
&gt;
* upload completely sent off: 24 out of 24 bytes
&lt; HTTP/1.1 201 Created
&lt; Date: Fri, 04 Sep 2015 03:12:37 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 23
* Server Jetty(9.3.0.M2) is not blacklisted
&lt; Server: Jetty(9.3.0.M2)
&lt;
* Connection #0 to host wifi-9-152.tpcity.corp.yahoo.com left intact
{&quot;age&quot;:0,&quot;name&quot;:&quot;name&quot;}
</code></pre>

<h3 id="how-do-i-define-customized-error-layout">How do I define customized error layout?</h3>
<ul>
<li>define your error object in .rdl, and specify status code mapping to
    your custom data object</li>
</ul>
<p><em>sample.rdl</em></p>
<pre><code>type MyResourceError struct {
    string errorValue;
}

resource User GET &quot;/user/{id}&quot; {
    int32 id;

    expected ACCEPTED;
    exceptions {
        ResourceError INTERNAL_SERVER_ERROR;
        MyResourceError BAD_REQUEST;
        ResourceError UNAUTHORIZED;
        ResourceError FORBIDDEN;
    }
}
</code></pre>

<ul>
<li>the custom error object and exception mapping of endpoint resources
    will be generated by rdl generator</li>
</ul>
<p><em>SampleResources.java (No need to implemented)</em></p>
<pre><code>@Path(&quot;/sample/v1&quot;)
public class SampleResources {

   @GET
   @Path(&quot;/user/{id}&quot;)
   @Produces(MediaType.APPLICATION_JSON)
   public User getUser(
       @PathParam(&quot;id&quot;) Integer id
   ) {
       try {
           ResourceContext context = _delegate.newResourceContext(_request, _response);
           User e = _delegate.getUser(context, id);
           return e;
       } catch (ResourceException e) {
           int code = e.getCode();
           switch (code) {
           case ResourceException.BAD_REQUEST:
               throw typedException(code, e, MyResourceError.class);
           case ResourceException.UNAUTHORIZED:
               throw typedException(code, e, ResourceError.class);
           case ResourceException.FORBIDDEN:
               throw typedException(code, e, ResourceError.class);
           case ResourceException.INTERNAL_SERVER_ERROR:
               throw typedException(code, e, ResourceError.class);
           default:
               System.err.println(&quot;*** Warning: undeclared exception (&quot;+code+&quot;) for resource getUser&quot;);
               throw typedException(code, e, ResourceError.class);
           }
       }
   }
}
</code></pre>

<p><em>MyResourceError.java (No need to implemented)</em></p>
<pre><code>public class MyResourceError {

   public String errorValue;

   public MyResourceError message(String errorValue) {
       this.errorValue = errorValue;
       return this;
   }

   public String toString() {
       return &quot;{errorValue: \&quot;&quot; + errorValue + &quot;\&quot;}&quot;;
   }

}
</code></pre>

<ul>
<li>you only need to throw ResourceException with your custom error
    object (the code must match with the object you defined in rdl)</li>
</ul>
<pre><code>public class SampleHandlerImpl implements SampleHandler {

   @Override
   public User getUser(ResourceContext context, Integer id) {
       User user = new User();
       user.setName(&quot;dm4&quot;);

       // throw your custom error object depends on your business logic
       if (id &gt; 100) {
           MyResourceError e = new MyResourceError();
           e.setErrorValue(id + &quot; is invalid&quot;);
           throw new ResourceException(ResourceException.BAD_REQUEST, e);
       }
       return user;
   }

   ...
}
</code></pre>

<ul>
<li>the output will be</li>
</ul>
<pre><code>$ curl -v http://wifi-9-152.tpcity.corp.yahoo.com:8080/api/sample/v1/user/101

* Hostname was NOT found in DNS cache
*   Trying 10.82.9.152...
* Connected to wifi-9-152.tpcity.corp.yahoo.com (10.82.9.152) port 8080 (#0)
&gt; GET /api/sample/v1/user/101 HTTP/1.1
&gt; User-Agent: curl/7.37.1
&gt; Host: wifi-9-152.tpcity.corp.yahoo.com:8080
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 400 Bad Request
&lt; Date: Fri, 04 Sep 2015 02:13:18 GMT
&lt; Content-Type: application/json
&lt; Content-Length: 34
* Server Jetty(9.3.0.M2) is not blacklisted
&lt; Server: Jetty(9.3.0.M2)
&lt;
* Connection #0 to host wifi-9-152.tpcity.corp.yahoo.com left intact
{&quot;errorValue&quot;:&quot;101 is invalid&quot;}
</code></pre>

<h3 id="how-to-change-slf4j-logger-binding">How to change slf4j logger binding?</h3>
<ul>
<li>Parsec archetype generate build.gradle default binding implementation to
    log4j, you could change to logback or any other logger
    implementation what you like.</li>
<li>Below build.gradle example demo howto change binding to logback</li>
</ul>
<pre><code>dependencies {
    // ...
    compile group: 'ch.qos.logback', name: 'logback-classic', version: '1.1.9'
    // ...
}
</code></pre>

<ul>
<li>Detail info could reference <a href="http://www.slf4j.org/manual.html#projectDep">slf4j
    doc</a></li>
</ul>
<h2 id="pending">Pending</h2>
<h3 id="what-does-public-void-authorizestring-action-string-resource-string-trusteddomain-mean-rdl-generated-code-and-how-do-i-use-it">What does “public void authorize(String action, String resource, String trustedDomain)” mean (rdl generated code) and how do I use it?</h3>
<h3 id="how-do-i-define-webapp-root-path">How do I define webapp root path?</h3>
<h3 id="how-do-i-define-different-constraint-rule-in-same-data-object-for-different-endpoint">How do I define different constraint rule in same data object for different endpoint?</h3>
<h3 id="how-do-i-define-multipart-in-rdl">How do I define multipart in rdl?</h3></div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>Copyright &copy; 2017 <a href="http://www.yahoo.com">Yahoo! Inc.</a></p>
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script>var base_url = '..';</script>
        <script src="../js/base.js"></script>
        <script src="../search/require.js"></script>
        <script src="../search/search.js"></script>

        <div class="modal" id="mkdocs_search_modal" tabindex="-1" role="dialog" aria-labelledby="Search Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Search</h4>
            </div>
            <div class="modal-body">
                <p>
                    From here you can search these documents. Enter
                    your search terms below.
                </p>
                <form role="form">
                    <div class="form-group">
                        <input type="text" class="form-control" placeholder="Search..." id="mkdocs-search-query">
                    </div>
                </form>
                <div id="mkdocs-search-results"></div>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div><div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="Keyboard Shortcuts Modal" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h4 class="modal-title" id="exampleModalLabel">Keyboard Shortcuts</h4>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td><kbd>&larr;</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td><kbd>&rarr;</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>


    </body>
</html>
